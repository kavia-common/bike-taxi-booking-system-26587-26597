{"is_source_file": true, "format": "Python", "description": "This file contains authentication utilities for a FastAPI backend, including password hashing, JWT token creation and validation, and user role verification.", "external_files": ["src.api.config", "src.api.models"], "external_methods": ["settings.access_token_exp_minutes", "settings.app_name", "settings.api_version", "settings.jwt_algorithm", "settings.jwt_secret_key", "User", "Role", "USERS"], "published": ["create_access_token", "get_current_user", "require_role"], "classes": [], "methods": [{"name": "Tuple[str,int] create_access_token(user: User)", "description": "Creates a signed JWT token for the given user, with expiration based on settings.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user(credentials: Optional[HTTPAuthorizationCredentials] = Depends(security))", "description": "FastAPI dependency that extracts and verifies the current user from the authorization header.", "scope": "", "scopeKind": ""}, {"name": "require_role(required: Role)", "description": "Factory for a dependency that enforces a specific user role for route access.", "scope": "", "scopeKind": ""}, {"name": "str _b64url(data: bytes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bytes _b64url_decode(data: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[dict,dict] _jwt_decode(token: str, secret: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _jwt_sign(header: dict, payload: dict, secret: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "User dependency(user: User = Depends(get_current_user))", "scope": "require_role", "scopeKind": "function", "description": "unavailable"}, {"name": "str hash_password(raw: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool verify_password(raw: str, hashed: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["_jwt_sign", "_jwt_decode", "hash_password", "hmac.compare_digest", "json.dumps", "json.loads", "base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "datetime.utcnow", "timedelta"], "search-terms": ["JWT token creation", "FastAPI auth dependencies", "password hashing", "role-based access", "Auth utility functions"], "state": 2, "file_id": 8, "knowledge_revision": 17, "git_revision": "", "ctags": [{"_type": "tag", "name": "_b64url", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def _b64url(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "_b64url_decode", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def _b64url_decode(data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: str)"}, {"_type": "tag", "name": "_jwt_decode", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def _jwt_decode(token: str, secret: str) -> Tuple[dict, dict]:$/", "language": "Python", "typeref": "typename:Tuple[dict,dict]", "kind": "function", "signature": "(token: str, secret: str)"}, {"_type": "tag", "name": "_jwt_sign", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def _jwt_sign(header: dict, payload: dict, secret: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(header: dict, payload: dict, secret: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def create_access_token(user: User) -> Tuple[str, int]:$/", "language": "Python", "typeref": "typename:Tuple[str,int]", "kind": "function", "signature": "(user: User)"}, {"_type": "tag", "name": "dependency", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^    def dependency(user: User = Depends(get_current_user)) -> User:$/", "file": true, "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(user: User = Depends(get_current_user))", "scope": "require_role", "scopeKind": "function"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def get_current_user(credentials: Optional[HTTPAuthorizationCredentials] = Depends(security)) ->/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(credentials: Optional[HTTPAuthorizationCredentials] = Depends(security))"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def hash_password(raw: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(raw: str)"}, {"_type": "tag", "name": "require_role", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def require_role(required: Role):$/", "language": "Python", "kind": "function", "signature": "(required: Role)"}, {"_type": "tag", "name": "security", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^security = HTTPBearer(auto_error=False)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/bike-taxi-booking-system-26587-26597/bike_taxi_backend/src/api/auth.py", "pattern": "/^def verify_password(raw: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(raw: str, hashed: str)"}], "hash": "bbe88014501790eaa52fd12c4034431a", "format-version": 4, "code-base-name": "bike_taxi_backend", "filename": "bike_taxi_backend/src/api/auth.py", "fields": [{"name": "security = HTTPBearer(auto_error=False)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"17": ""}]}